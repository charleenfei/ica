version: "3"

services:

  chain-test-1:
    image: icad:local
    command: bash /network/start.sh
    environment:
      CHAINID: test-1
      GRPCPORT: 8090
      GRPCWEB: 8091
    volumes:
      - ./storage:/home/ubuntu/data
      - ./network:/network
  
  chain-test-2:
    image: icad:local
    command: bash /network/start.sh
    environment:
      CHAINID: test-2
      GRPCPORT: 8090
      GRPCWEB: 8091
    volumes:
      - ./storage:/home/ubuntu/data
      - ./network:/network

  relayer:
    image: relayer:local
    command: bash ./network/relayer/interchain-acc-config/rly-start.sh
    volumes:
      - ./storage:/src/app/data
      - ./network:/src/app/network

  controller-oracle:
    image: oracle:local
    command: bash /src/app/oracle/run_controller_oracle.sh
    environment:
      CMP_CONTROLLER_CHAIN_ID: test-1
      CMP_CHAIN_WS: ws://chain-test-1:16657/websocket
      CMP_CONTROLLER_CHAIN_HOME: /src/app/data/test-1
    volumes:
      - ./oracle:/src/app/oracle
      - ./storage:/src/app/data
  
  host-oracle:
    image: oracle:local
    command: bash /src/app/oracle/run_host_oracle.sh
    environment:
      CMP_CONTROLLER_CHAIN_ID: test-2
      CMP_CHAIN_WS: ws://chain-test-2:26657/websocket
      CMP_CONTROLLER_CHAIN_HOME: /src/app/data/test-2
    volumes:
      - ./oracle:/src/app/oracle
      - ./storage:/src/app/data
